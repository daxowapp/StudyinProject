# Program Slug Implementation Guide

## Overview
Implemented slug-based routing for program pages with format: `program-name-university-name`

## Changes Made

### 1. Database Migration
**File:** `DATABASE_MIGRATION_ADD_PROGRAM_SLUG.sql`

- Added `slug` column to `university_programs` table
- Created `generate_program_slug()` function to generate SEO-friendly slugs
- Created automatic trigger to generate slugs on insert/update
- Updated `v_university_programs_full` view to include slug field
- Added index on slug column for performance

**Slug Format:** `{program-title}-{university-name}`
- Example: `computer-science-tsinghua-university`
- Example: `business-administration-peking-university`

### 2. Frontend Changes

#### New Route
- **Created:** `/src/app/(public)/programs/[slug]/page.tsx`
- Replaced ID-based routing with slug-based routing
- Queries database using `slug` instead of `id`
- Better SEO and user-friendly URLs

#### Updated Components
- **ProgramCard.tsx:** Updated to use `slug` in links (fallback to `id` if slug not available)
- **programs/page.tsx:** Added `slug` field to formatted program data

### 3. Old Route
The old `/programs/[id]/page.tsx` route still exists for backward compatibility, but new links will use the slug-based route.

## How to Apply

### Step 1: Run Database Migration
```bash
# Connect to your Supabase database and run:
psql -h your-db-host -U postgres -d postgres -f DATABASE_MIGRATION_ADD_PROGRAM_SLUG.sql
```

Or via Supabase Dashboard:
1. Go to SQL Editor
2. Copy contents of `DATABASE_MIGRATION_ADD_PROGRAM_SLUG.sql`
3. Execute the SQL

### Step 2: Verify Migration
Check that slugs were generated:
```sql
SELECT id, slug, custom_title FROM university_programs LIMIT 10;
```

### Step 3: Test the Application
```bash
npm run dev
```

Visit:
- Old URL: `http://localhost:3000/programs/820d4cdc-0bb6-491b-8eb8-7b86784f96a9` (still works via old route)
- New URL: `http://localhost:3000/programs/computer-science-tsinghua-university` (new slug-based route)

## Benefits

1. **SEO Friendly:** Descriptive URLs help search engines understand page content
2. **User Friendly:** Users can read and understand the URL
3. **Shareable:** URLs are more memorable and shareable
4. **Unique:** Combines program name + university name to ensure uniqueness

## Example URLs

Before:
- `/programs/820d4cdc-0bb6-491b-8eb8-7b86784f96a9`

After:
- `/programs/computer-science-tsinghua-university`
- `/programs/mba-master-of-business-administration-peking-university`
- `/programs/mbbs-bachelor-of-medicine-bachelor-of-surgery-fudan-university`

## Backward Compatibility

The old `[id]` route is still functional, so existing bookmarks and links will continue to work. However, all new links generated by the application will use the slug-based format.

## Next Steps (Optional)

1. **Redirect old URLs:** Add a redirect from `/programs/[id]` to `/programs/[slug]`
2. **Remove old route:** Once all traffic is migrated, remove the `[id]` folder
3. **Add canonical tags:** Ensure SEO tools recognize the slug-based URL as canonical
